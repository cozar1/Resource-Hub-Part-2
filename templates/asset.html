{% extends "template.html" %}
{% block content %}
<div class="grid-3">
<h1>{{asset[0][1]}}</h1>
<h1>Description</h1>
<h1>Downloads</h1>
</div>

<div class="grid-3">
    <div class="vertical_align">
        {% set default_type = available_downloads[0] if available_downloads else None %}
        <img id="asset-preview-img" class="image" src="{% if default_type %}/static/images/{{asset[0][0]}}{{default_type}}.png{% else %}/static/images/placeholder.png{% endif %}">
        <div class="img-types">
            {% if available_downloads %}
                {% for suffix in available_downloads %}
                <div class="button img-type-btn" data-type="{{suffix}}" data-asset-id="{{asset[0][0]}}">{{suffix.upper()}}</div>
                {% endfor %}
            {% endif %}
        </div>
        <div class="tag-grid">
            {% for tag in assettags %}
            <span class="button"><i class="{{tag[1]}}"></i> {{ tag[0] }}</span>
            {% endfor %}
        </div> 
    </div>

    <div class="vertical_align">
        <h2>{{asset[0][5] | safe}}</h2>
    </div>

    <div class="vertical_align">
        {% if available_downloads %}
            {% for suffix in available_downloads %}
                {% if suffix == 'd' %}
                    <a class="button" href="/download/{{asset[0][0]}}/d">Diffuse Map <i class="fa-solid fa-download"></i></a>
                {% elif suffix == 'n' %}
                    <a class="button" href="/download/{{asset[0][0]}}/n">Normal Map <i class="fa-solid fa-download"></i></a>
                {% elif suffix == 's' %}
                    <a class="button" href="/download/{{asset[0][0]}}/s">Specular Map <i class="fa-solid fa-download"></i></a>
                {% elif suffix == 'o' %}
                    <a class="button" href="/download/{{asset[0][0]}}/o">Occlusion Map <i class="fa-solid fa-download"></i></a>
                {% endif %}
            {% endfor %}
        {% else %}
            <p>No downloadable files available.</p>
        {% endif %}
        <br>
        <h1>Stats</h1>
        <p>Views: {{asset[0][2]}}</p>
        <p>Downloads: {{asset[0][3]}}</p>
        <p>Likes: {{asset[0][4]}}</p>

    </div>
</div>

<script>
    // Handle image type switching on asset page
    document.addEventListener('DOMContentLoaded', function() {
        const imgTypeButtons = document.querySelectorAll('.img-type-btn');
        const previewImg = document.getElementById('asset-preview-img');
        
        imgTypeButtons.forEach(button => {
            button.addEventListener('click', function() {
                const imageType = this.getAttribute('data-type');
                const assetId = this.getAttribute('data-asset-id');
                
                // Update the image source
                previewImg.src = `/static/images/${assetId}${imageType}.png`;
                
                // Update button states
                imgTypeButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // Set the first button as active by default if available
        if (imgTypeButtons.length > 0) {
            imgTypeButtons[0].classList.add('active');
        }
    });
</script>
{% endblock %}