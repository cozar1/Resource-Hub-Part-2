{% extends "template.html" %}
{% block content %}
<form action="/upload" method="post" enctype="multipart/form-data">
    <div class="upload-grid">
        <div class="text-input-fields">
            <div class="input-name">
                <h1>Name</h1>
                <input class="input" type="text" name="name">
            </div>
            <div class="input-name">
                <h1>Description</h1>
                <input class="input" type="text" name="description">
            </div>
            <h1>Tag(s)</h1>
            <div class="input-tags">
                {% for tag in tags %}
                <div>
                    <input class="tag-input" type="checkbox" name="tags" value="{{ tag[0] }}">
                    <h2>{{ tag[1] }}</h2>
                </div>
                {% endfor %}
            </div>
            
        </div>
        <div class="upload-preview">
            <h1>Preview</h1>
            <img id="preview-img" class="image-preview" src="../static/images/error.jpg">
            <button type="submit" class="upload-button">Upload!</button>
        </div>
        <div class="image-input-fields">
            <h1>Diffuse Map</h1>
            <label class="custom-file-upload">
                <input type="file" name="diffuse" accept=".png, .jpg" onchange="updateFileName(this, 'diffuse-file-name','preview-img')">
                <span id="diffuse-file-name">No file chosen</span>
            </label>
            <h1>Normal Map</h1>
            <label class="custom-file-upload">
                <input type="file" name="normal" accept=".png, .jpg" onchange="updateFileName(this, 'normal-file-name')">
                <span id="normal-file-name">No file chosen</span>
            </label>
            <h1>Specular Map</h1>
            <label class="custom-file-upload">
                <input type="file" name="specular" accept=".png, .jpg" onchange="updateFileName(this, 'specular-file-name')">
                <span id="specular-file-name">No file chosen</span>
            </label>
            <h1>Occlusion Map</h1>
            <label class="custom-file-upload">
                <input type="file" name="occlusion" accept=".png, .jpg" onchange="updateFileName(this, 'occlusion-file-name')">
                <span id="occlusion-file-name">No file chosen</span>
            </label>
        </div>
    </div>
</form>

<script>
    function updateFileName(input, spanId, previewId = null) {
        const fileName = input.files.length > 0 ? input.files[0].name : 'No file chosen';
        document.getElementById(spanId).textContent = fileName;

        // if previewId provided, show image preview
        if (previewId && input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById(previewId).src = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
{% endblock %}

